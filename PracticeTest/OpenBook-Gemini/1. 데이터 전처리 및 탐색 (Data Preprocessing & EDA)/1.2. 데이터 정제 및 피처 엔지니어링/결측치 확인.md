# 결측치 확인: isnull, isna

## 개념 요약

결측치(Missing Value)는 데이터 수집 과정에서 누락되거나 비어 있는 값을 의미하며, 보통 `NaN` (Not a Number)으로 표현됩니다. 결측치는 분석 결과의 왜곡을 초래하거나, 모델 학습 시 에러를 발생시킬 수 있으므로 반드시 확인하고 처리해야 합니다. Pandas는 결측치를 탐지하기 위한 두 가지 동일한 기능을 수행하는 메서드를 제공합니다.

- **`isnull()`**: 데이터프레임 또는 시리즈의 각 원소가 결측치인지 아닌지를 검사하여, 결측치이면 `True`, 아니면 `False`를 담은 불리언(Boolean) 객체를 반환합니다.
- **`isna()`**: `isnull()`과 완전히 동일한 기능을 하는 메서드입니다. 두 메서드는 이름만 다를 뿐, 성능이나 기능 면에서 차이가 없습니다. 일관성 있는 코드 작성을 위해 둘 중 하나를 선택하여 사용하는 것이 좋습니다.

이 메서드들은 보통 `sum()`과 함께 사용되어 각 열(column)에 포함된 결측치의 총 개수를 파악하는 데 쓰입니다.

## 적용 가능한 상황

- **데이터 품질 검증**: 데이터를 처음 불러온 후, 각 변수에 결측치가 얼마나 포함되어 있는지 확인하여 데이터의 완전성을 평가할 때.
- **결측치 처리 전략 수립**: 결측치의 개수와 비율을 파악하여, 해당 변수를 제거할지, 특정 값으로 채울지(대체), 아니면 결측치를 예측하는 모델을 만들지 등의 처리 방법을 결정하기 전 단계.
- **데이터 시각화**: `seaborn`의 `heatmap`과 결합하여 데이터셋 전체의 결측치 분포 패턴을 시각적으로 확인할 때.

## 구현 방법

### 예제 데이터프레임 생성

```python
import pandas as pd
import numpy as np

data = {'A': [1, 2, np.nan, 4],
        'B': [5, np.nan, np.nan, 8],
        'C': ['x', 'y', 'z', 'w'],
        'D': [np.nan, None, np.nan, np.nan]}
df = pd.DataFrame(data)
```
*Note: Numpy의 `np.nan`과 Python 내장 `None`은 모두 Pandas에서 결측치로 인식됩니다.*

### 1. `isnull()` / `isna()`

- **용도**: 데이터의 각 원소가 결측치인지 여부를 확인합니다.
- **주의사항**: 메서드 자체만으로는 결측치의 위치만 알 수 있습니다. 결측치의 개수를 파악하려면 `sum()`을, 비율을 파악하려면 `mean()`을 함께 사용해야 합니다.
- **코드 예시**:
  ```python
  # isnull()을 사용하여 결측치 위치 확인
  print("--- isnull() result ---")
  print(df.isnull())

  # isna()는isnull()과 동일한 결과를 반환합니다.
  # print(df.isna())
  ```
- **결과 해석**:
  ```
  --- isnull() result ---
         A      B      C     D
  0  False  False  False  True
  1  False   True  False  True
  2   True   True  False  True
  3  False  False  False  True
  ```
  결과로 반환된 데이터프레임은 원본 데이터프레임과 동일한 형태를 가지며, 결측치가 있는 위치가 `True`로 표시됩니다.

### 2. `isnull().sum()`

- **용도**: 각 열에 있는 결측치의 총 개수를 계산합니다.
- **주의사항**: `sum()` 함수는 기본적으로 열(axis=0) 단위로 합계를 계산합니다. 행(axis=1) 단위로 결측치 개수를 세려면 `axis=1` 인자를 추가합니다.
- **코드 예시**:
  ```python
  # 각 열의 결측치 개수 확인
  print("--- Missing values per column ---")
  print(df.isnull().sum())

  # 전체 데이터프레임의 총 결측치 개수 확인
  print("\n--- Total missing values in DataFrame ---")
  print(df.isnull().sum().sum())
  ```
- **결과 해석**:
  ```
  --- Missing values per column ---
  A    1
  B    2
  C    0
  D    4
  dtype: int64

  --- Total missing values in DataFrame ---
  7
  ```
  - 각 열(A, B, C, D)에 포함된 결측치의 개수를 시리즈 형태로 보여줍니다. `A`는 1개, `B`는 2개, `D`는 4개의 결측치를 가지고 있음을 알 수 있습니다.
  - `.sum()`을 두 번 사용하면 데이터프레임 전체의 결측치 총합(7개)을 계산할 수 있습니다.

### 3. 결측치 비율 확인

- **용도**: 전체 데이터 대비 결측치가 차지하는 비율을 확인하여, 결측의 심각성을 판단합니다.
- **코드 예시**:
  ```python
  # 각 열의 결측치 비율 확인
  print("--- Missing value ratio per column ---")
  print(df.isnull().mean() * 100)
  ```
- **결과 해석**:
  ```
  --- Missing value ratio per column ---
  A     25.0
  B     50.0
  C      0.0
  D    100.0
  dtype: float64
  ```
  - `D` 열은 100% 결측치이므로, 분석에 사용할 수 없어 제거 대상이 될 가능성이 높습니다.
  - `B` 열은 50%의 높은 결측 비율을 가지므로, 단순한 평균값 대체보다는 더 정교한 처리 방법이 필요할 수 있습니다.

### 4. 결측치 시각화

- **용도**: 결측치의 분포 패턴을 시각적으로 파악합니다.
- **주의사항**: `seaborn` 라이브러리가 필요합니다. (`pip install seaborn`)
- **코드 예시**:
  ```python
  import seaborn as sns
  import matplotlib.pyplot as plt

  plt.figure(figsize=(8, 5))
  sns.heatmap(df.isnull(), cbar=False, cmap='viridis')
  plt.title('Missing Value Heatmap')
  plt.show()
  ```
- **결과 해석**: 히트맵에서 노란색(또는 지정된 색상)으로 표시된 부분이 결측치를 의미합니다. 이를 통해 특정 행이나 열에 결측치가 집중되어 있는지, 또는 무작위로 분포하는지 등의 패턴을 한눈에 파악할 수 있습니다.

## 장단점 및 대안

| 메서드 | 장점 | 단점 | 대안/보완 |
|---|---|---|---|
| **`isnull()` / `isna()`** | 직관적이고 사용하기 쉬움. Pandas의 기본 기능으로 추가 라이브러리 불필요. | 그 자체만으로는 요약 정보를 주지 못하고, `sum()`이나 `mean()`과 결합해야 함. | `notnull()` / `notna()`: `isnull()`/`isna()`와 정반대로, 결측치가 아닌 유효한 값의 위치를 `True`로 반환함. 유효한 데이터의 개수를 셀 때 `df.notnull().sum()`과 같이 사용할 수 있음. |
| **`isnull().sum()`** | 각 열의 결측치 개수를 빠르고 간결하게 요약해줌. | 결측치의 위치나 패턴에 대한 정보는 제공하지 않음. | `df.info()`: `Non-Null Count`를 통해 결측치 개수를 간접적으로 확인할 수 있으며, 데이터 타입 정보까지 함께 제공함. |
| **시각화 (Heatmap)** | 결측치 분포의 전체적인 패턴과 집중도를 시각적으로 파악하는 데 매우 효과적. | 데이터가 매우 클 경우(행/열이 많을 경우) 히트맵이 잘 보이지 않거나 렌더링이 느려질 수 있음. | `missingno` 라이브러리 (`pip install missingno`): 결측치 시각화에 특화된 라이브러리로, `msno.matrix()`, `msno.bar()` 등 더 다양하고 상세한 시각화 기능을 제공함. |
