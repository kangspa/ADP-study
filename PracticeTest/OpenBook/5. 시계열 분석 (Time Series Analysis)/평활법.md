### 평활법 (Smoothing Methods)

#### 개념 요약
평활법은 시계열 데이터에 포함된 불규칙한 변동(노이즈)을 제거하고, 데이터의 기본적인 추세(Trend)나 계절성(Seasonality)을 부각시켜 미래를 예측하는 데 사용되는 기법입니다. 주로 단기 예측에 유용하며, 데이터의 패턴을 부드럽게 만들어 분석을 용이하게 합니다.

주요 평활법은 다음과 같습니다.

1.  **이동평균법 (Moving Average, MA)**:
    - **개념**: 특정 기간(윈도우 크기) 동안의 데이터 값들의 평균을 계산하여 시계열을 평활하는 방법입니다. 새로운 데이터가 들어오면 가장 오래된 데이터를 버리고 새로운 데이터를 포함하여 평균을 다시 계산합니다.
    - **종류**:
        - **단순 이동평균 (Simple Moving Average, SMA)**: 모든 데이터에 동일한 가중치를 부여하여 평균을 계산합니다.
        - **가중 이동평균 (Weighted Moving Average, WMA)**: 최근 데이터에 더 높은 가중치를 부여하여 평균을 계산합니다.
    - **장점**: 구현이 간단하고 직관적입니다.
    - **단점**: 윈도우 크기만큼의 과거 데이터가 필요하며, 급격한 변화에 둔감하고, 추세나 계절성을 잘 반영하지 못합니다.

2.  **지수평활법 (Exponential Smoothing)**:
    - **개념**: 과거 데이터에 지수적으로 감소하는 가중치를 부여하여 평균을 계산하는 방법입니다. 즉, 최근 데이터에 더 큰 가중치를 부여하고, 오래된 데이터일수록 가중치를 작게 부여합니다.
    - **장점**: 이동평균법보다 최근 데이터의 변화를 더 잘 반영하며, 모든 과거 데이터를 사용하므로 정보 손실이 적습니다.
    - **단점**: 평활 계수(smoothing parameter)를 적절히 설정해야 합니다.

    - **주요 지수평활법 모델**:
        - **단순 지수평활 (Simple Exponential Smoothing, SES)**: 추세나 계절성이 없는 정상 시계열에 적합합니다. 하나의 평활 계수($\alpha$)를 사용합니다.
        - **홀트 선형 추세법 (Holt's Linear Trend Method)**: 추세는 있지만 계절성이 없는 시계열에 적합합니다. 수준(level) 평활 계수($\alpha$)와 추세(trend) 평활 계수($\beta$)를 사용합니다.
        - **홀트-윈터스 계절성법 (Holt-Winters' Seasonal Method)**: 추세와 계절성이 모두 존재하는 시계열에 적합합니다. 수준($\alpha$), 추세($\beta$), 계절성($\gamma$) 평활 계수를 사용하며, 계절성 유형에 따라 덧셈 모델(Additive)과 곱셈 모델(Multiplicative)로 나뉩니다.

#### 적용 가능한 상황
- 시계열 데이터의 노이즈를 제거하고 기본적인 패턴을 파악하고자 할 때.
- 단기적인 미래 값을 예측하고자 할 때.
- 데이터에 추세나 계절성이 명확하게 존재할 때 (특히 지수평활법).

#### 구현 방법
- 이동평균법은 `pandas`의 `rolling().mean()` 함수를 사용합니다.
- 지수평활법은 `statsmodels` 라이브러리의 `ExponentialSmoothing` 클래스를 사용합니다.

##### 용도
- 시계열 데이터의 불규칙한 변동을 제거하고, 추세 및 계절성을 파악하여 미래 값을 예측합니다.

##### 주의사항
- **윈도우 크기/평활 계수**: 이동평균법의 윈도우 크기나 지수평활법의 평활 계수들은 모델의 성능에 큰 영향을 미치는 하이퍼파라미터입니다. 교차 검증이나 정보 기준(AIC, BIC)을 통해 최적의 값을 찾아야 합니다.
- **데이터의 특성**: 데이터에 추세, 계절성 여부에 따라 적절한 평활법 모델을 선택해야 합니다.

##### 코드 예시
```python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from statsmodels.tsa.api import ExponentialSmoothing, SimpleExpSmoothing, Holt

# 1. 시계열 데이터 생성 (추세와 계절성 포함)
np.random.seed(42)
dates = pd.date_range(start='2010-01-01', periods=100, freq='M')
data = 50 + np.arange(100) * 0.5 + 10 * np.sin(np.arange(100) * 2 * np.pi / 12) + np.random.randn(100) * 5
ts = pd.Series(data, index=dates)

plt.figure(figsize=(12, 6))
plt.plot(ts, label='Original Series')
plt.title('Original Time Series with Trend and Seasonality')
plt.legend()
plt.show()

# 2. 이동평균법 (Moving Average)
# window: 이동평균을 계산할 윈도우 크기.
# min_periods: 윈도우 내 최소 데이터 수.
ts_ma = ts.rolling(window=12, min_periods=1).mean()

plt.figure(figsize=(12, 6))
plt.plot(ts, label='Original Series')
plt.plot(ts_ma, label='Moving Average (window=12)', color='red')
plt.title('Moving Average Smoothing')
plt.legend()
plt.show()

# 3. 지수평활법 (Holt-Winters)
# Holt-Winters' Seasonal Method 하이퍼파라미터
# seasonal_periods: 계절성 주기 (e.g., 월별 데이터면 12, 분기별이면 4)
# trend: 추세 유형 ('add' for additive, 'mul' for multiplicative)
# seasonal: 계절성 유형 ('add' for additive, 'mul' for multiplicative)
# smoothing_level (alpha): 수준 평활 계수.
# smoothing_trend (beta): 추세 평활 계수.
# smoothing_seasonal (gamma): 계절성 평활 계수.
#   - 이 계수들은 0과 1 사이의 값을 가지며, 1에 가까울수록 최근 데이터에 더 큰 가중치를 부여.
#   - 보통 fit() 메서드에서 자동으로 최적화된 값을 찾아줌.

# 덧셈 모델 (Additive Model)
fit_add = ExponentialSmoothing(ts, seasonal_periods=12, trend='add', seasonal='add', use_boxcox=True, initialization_method="estimated").fit()
pred_add = fit_add.forecast(12) # 12개월 예측

# 곱셈 모델 (Multiplicative Model)
fit_mul = ExponentialSmoothing(ts, seasonal_periods=12, trend='mul', seasonal='mul', use_boxcox=True, initialization_method="estimated").fit()
pred_mul = fit_mul.forecast(12) # 12개월 예측

plt.figure(figsize=(12, 6))
plt.plot(ts, label='Original Series')
plt.plot(fit_add.fittedvalues, label='Holt-Winters Additive Fit', color='green')
plt.plot(pred_add, label='Holt-Winters Additive Forecast', color='green', linestyle='--')
plt.plot(fit_mul.fittedvalues, label='Holt-Winters Multiplicative Fit', color='purple')
plt.plot(pred_mul, label='Holt-Winters Multiplicative Forecast', color='purple', linestyle='--')
plt.title('Holt-Winters Exponential Smoothing')
plt.legend()
plt.show()

print("\nHolt-Winters Additive 모델 파라미터:")
print(fit_add.params)
print("\nHolt-Winters Multiplicative 모델 파라미터:")
print(fit_mul.params)
```

##### 결과 해석 방법
- **이동평균**: 평활된 시계열은 원본 시계열보다 불규칙한 변동이 줄어들어 추세를 더 명확하게 보여줍니다.
- **지수평활법**:
    - `fittedvalues`: 모델이 훈련 데이터에 대해 예측한 값으로, 평활된 시계열을 나타냅니다.
    - `forecast()`: 미래 시점에 대한 예측값을 제공합니다.
    - `params`: 학습된 평활 계수($\alpha, \beta, \gamma$)를 확인할 수 있습니다. 이 값들을 통해 모델이 과거 데이터에 얼마나 가중치를 부여했는지 알 수 있습니다.
    - 덧셈 모델과 곱셈 모델 중 어떤 것이 더 적합한지는 시각적으로 확인하거나, AIC, BIC와 같은 정보 기준을 통해 비교할 수 있습니다.

#### 장단점 및 대안
- **장점**:
    - 구현이 비교적 간단하고 직관적입니다.
    - 단기 예측에 효과적이며, 추세나 계절성을 잘 반영할 수 있습니다.
- **단점**:
    - 장기 예측에는 적합하지 않습니다.
    - 평활 계수나 윈도우 크기 등 하이퍼파라미터 튜닝이 필요합니다.
    - 데이터의 복잡한 패턴(e.g., 여러 계절성, 불규칙한 주기)을 모델링하기 어렵습니다.
- **대안**:
    - **ARIMA/SARIMA 모델**: 시계열의 자기상관 구조를 명시적으로 모델링하여 더 정교한 예측을 수행합니다.
    - **Prophet**: 페이스북에서 개발한 시계열 예측 라이브러리로, 휴일 효과나 여러 계절성을 자동으로 처리하며, 비전문가도 쉽게 사용할 수 있습니다.
    - **머신러닝/딥러닝 모델**: 시계열 데이터를 특성으로 변환하여 일반적인 회귀 모델을 적용하거나, LSTM과 같은 딥러닝 모델을 사용하여 복잡한 시계열 패턴을 학습할 수 있습니다.

```