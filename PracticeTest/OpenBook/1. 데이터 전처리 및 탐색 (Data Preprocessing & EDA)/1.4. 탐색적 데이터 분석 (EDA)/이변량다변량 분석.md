# 이변량/다변량 분석 (Bivariate/Multivariate Analysis)

## 개념 요약

단변량 분석이 각 변수를 개별적으로 살펴보는 것이었다면, 이변량/다변량 분석은 두 개 이상의 변수들 사이의 관계와 상호작용을 탐색하는 과정입니다. 이 분석을 통해 변수들이 서로 어떤 영향을 미치는지, 특정 조건 하에서 데이터가 어떻게 달라지는지 등 더 깊은 인사이트를 발견할 수 있습니다. 분석하려는 변수들의 조합(수치형/범주형)에 따라 적합한 분석 방법과 시각화 기법이 달라집니다.

- **이변량 분석 (Bivariate Analysis)**: 두 개의 변수 간의 관계를 분석합니다.
    - **수치형 vs 수치형**: 산점도(Scatter Plot)를 그려 두 변수의 선형성, 방향성, 강도를 시각적으로 확인하고, 상관 계수(Correlation Coefficient)를 계산하여 관계를 정량화합니다.
    - **범주형 vs 수치형**: 특정 범주에 따른 수치형 변수의 분포 변화를 확인합니다. 그룹별 기술 통계량을 계산하거나, 박스 플롯(Box Plot), 바이올린 플롯(Violin Plot) 등으로 분포를 시각적으로 비교합니다.
    - **범주형 vs 범주형**: 두 변수의 카테고리 조합에 따른 빈도를 교차표(Crosstabulation Table)로 나타내고, 누적/그룹 막대 그래프(Stacked/Grouped Bar Chart)로 시각화하여 관계를 파악합니다.

- **다변량 분석 (Multivariate Analysis)**: 세 개 이상의 변수 간의 관계를 동시에 분석합니다. 이변량 분석을 확장하여, `hue`, `size`, `style` 등의 옵션을 추가하여 제3, 제4의 변수를 시각화에 포함시키는 방식으로 주로 수행됩니다. (e.g., 산점도에 색상과 크기로 추가 변수 표현)

## 적용 가능한 상황

- **가설 검증**: '객실 등급이 높을수록 생존율이 높을 것이다'(범주형 vs 범주형), '나이가 많을수록 운임 요금을 더 많이 냈을 것이다'(수치형 vs 수치형)와 같은 가설을 데이터로 확인할 때.
- **피처 엔지니어링**: 변수 간의 강한 상관관계를 확인하여 다중공선성 문제를 인지하거나, 변수들의 상호작용을 나타내는 새로운 파생 변수를 만들 아이디어를 얻을 때.
- **모델링 변수 선택**: 타겟 변수(종속 변수)와 높은 상관관계를 갖는 독립 변수를 찾아 모델의 예측 변수로 사용하거나, 변수 간의 관계를 파악하여 모델링 전략을 수립할 때.

## 구현 방법

### 예제 데이터 생성

```python
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt

# Seaborn 내장 'titanic' 데이터셋 사용
df = sns.load_dataset('titanic')
```

### 1. 수치형 vs 수치형

- **분석 대상**: `age` vs `fare` (나이와 운임 요금의 관계)
- **용도**: 두 수치형 변수 간의 선형 관계, 패턴, 이상치를 파악합니다.
- **코드 예시**:
  ```python
  # 1-1. 산점도 (Scatter Plot)
  sns.scatterplot(x='age', y='fare', data=df)
  plt.title('Age vs Fare')
  plt.show()

  # 1-2. 상관 계수 (Correlation Coefficient)
  correlation = df[['age', 'fare']].corr(method='pearson')
  print("--- Correlation between Age and Fare ---")
  print(correlation)

  # 1-3. 다변량 분석: 산점도에 'survived' 변수 추가 (hue)
  sns.scatterplot(x='age', y='fare', hue='survived', data=df)
  plt.title('Age vs Fare by Survival')
  plt.show()
  ```
- **결과 해석**: 산점도를 보면 `age`와 `fare` 사이에 뚜렷한 선형 관계는 보이지 않습니다. 상관 계수도 약 0.09로 매우 낮아 두 변수 간의 선형 관계가 거의 없음을 수치적으로 보여줍니다. `hue` 옵션을 추가한 다변량 산점도를 통해 생존 여부에 따른 분포 차이를 탐색해볼 수 있습니다.

### 2. 범주형 vs 수치형

- **분석 대상**: `pclass` vs `age` (객실 등급에 따른 나이 분포)
- **용도**: 각 범주별로 수치형 데이터의 분포가 어떻게 다른지 비교합니다.
- **코드 예시**:
  ```python
  # 2-1. 그룹별 기술 통계량
  print("--- Age statistics by Pclass ---")
  print(df.groupby('pclass')['age'].describe())

  # 2-2. 박스 플롯 (Box Plot)
  plt.figure(figsize=(8, 6))
  sns.boxplot(x='pclass', y='age', data=df)
  plt.title('Age Distribution by Pclass')
  plt.show()

  # 2-3. 다변량 분석: 박스 플롯에 'sex' 변수 추가 (hue)
  plt.figure(figsize=(10, 6))
  sns.boxplot(x='pclass', y='age', hue='sex', data=df)
  plt.title('Age Distribution by Pclass and Sex')
  plt.show()
  ```
- **결과 해석**: 그룹별 통계량과 박스 플롯을 통해, 1등석(`pclass`=1) 승객의 평균 연령이 가장 높고, 3등석 승객의 평균 연령이 가장 낮다는 경향을 명확히 알 수 있습니다. `hue` 옵션을 추가하면, 각 객실 등급 내에서 남성과 여성의 나이 분포를 다시 비교해볼 수 있습니다.

### 3. 범주형 vs 범주형

- **분석 대상**: `pclass` vs `survived` (객실 등급과 생존 여부의 관계)
- **용도**: 두 범주형 변수의 카테고리 조합에 따른 빈도나 비율을 분석합니다.
- **코드 예시**:
  ```python
  # 3-1. 교차표 (Crosstab)
  crosstab_ps = pd.crosstab(df['pclass'], df['survived'])
  print("--- Crosstab: Pclass vs Survived ---")
  print(crosstab_ps)

  # 비율로 보기
  crosstab_ps_ratio = pd.crosstab(df['pclass'], df['survived'], normalize='index')
  print("\n--- Crosstab with Ratio ---")
  print(crosstab_ps_ratio)

  # 3-2. 그룹 막대 그래프 (Grouped Bar Chart)
  crosstab_ps_ratio.plot(kind='bar', stacked=False)
  plt.title('Survival Rate by Pclass')
  plt.ylabel('Survival Rate')
  plt.xticks(rotation=0)
  plt.show()
  ```
- **결과 해석**: 교차표와 막대 그래프를 통해, 1등석의 생존율이 약 63%로 가장 높은 반면, 3등석의 생존율은 약 24%로 가장 낮다는 것을 명확하게 확인할 수 있습니다. 이는 객실 등급이 생존 여부에 중요한 영향을 미치는 변수임을 시사합니다.

## 장단점 및 다변량 분석 도구

- **장점**: 변수 간의 복잡한 상호작용을 발견하고, 데이터에 대한 더 깊고 다각적인 이해를 가능하게 합니다.
- **단점**: 변수의 수가 늘어날수록 시각화와 해석이 복잡해지고 어려워집니다.

- **대표적인 다변량 시각화 도구**:
    - **`seaborn.pairplot`**: 데이터프레임의 모든 수치형 변수 쌍에 대한 산점도와 각 변수의 분포를 한 번에 그려주어, 변수 간의 전반적인 관계를 탐색하는 데 매우 강력합니다.
    - **`seaborn.heatmap`**: 상관계수 행렬을 시각화하여 여러 변수 간의 상관관계를 한눈에 파악하는 데 유용합니다.
    - **`seaborn.catplot`, `relplot`, `displot`**: `hue`, `col`, `row`, `size`, `style` 등의 인자를 활용하여 3개 이상의 변수를 포함하는 다차원적인 시각화를 쉽게 구현할 수 있습니다.

```