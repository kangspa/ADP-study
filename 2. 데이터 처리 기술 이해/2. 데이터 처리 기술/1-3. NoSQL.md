# NoSQL 개념 및 특징

- 데이터의 폭발적인 증가에 대응하기 위해 발달된 **분산 데이터베이스 기술**로 확장성, 가용성, 높은 성능을 제공한다.
- **비관계형 데이터베이스 관리 시스템**으로, SQL 계열 쿼리 언어 사용이 가능하다는 것을 강조하기 위해 "Not only SQL"로 부르기도 한다.
- 저장되는 데이터 구조에 따라 **Key-Value 모델, Document 모델(JSON, XML 중 채택), Graph 모델, Column 모델로 구분**된다.
- 스키마 없이 동작하며, 구조에 대한 정의 변경 없이 자유롭게 DB 레코드에 필드를 추가할 수 있다.
- 복잡한 Join 연산 기능은 지원하지 않지만, 대용량 데이터 처리와 대규모의 수평적 확장성을 제공한다.
- 대부분이 오픈소스로 제공된다.

# 구글 빅테이블

## 개념 및 특징

- 구글이 대용량 데이터 저장을 위해 개발한 분산 데이터 관리 저장소로, 구글 클라우드 플랫폼에서 사용된다.
- 데이터베이스 클러스터 분류 기준으로 따지면 **공유 디스크(Shared Disk)방식**이며, 모든 노드가 데이터, 인덱스 파일을 공유하고 있다.
- 실시간 서비스뿐만 아니라 주기적인 배치 작업과 대용량 데이터의 분석 처리에도 적합하도록 구성되어 있다.
- 유사 솔루션으로 아파치 오픈소스 프로젝트인 HBase와 NHN의 Neptune이 있다.

## 데이터 모델

- Multi-Dimension Sorted Hash Map을 파티션하여 분산 저장하는 저장소다.
- 테이블 내 모든 데이터는 **Row-Key의 사전적 순서로 정렬·저장**된다.
- 테이블의 파티션은 Row-Key를 이용하여 이루어지고, 분리된 파티션인 Tablet은 분산된 노드에서 서비스된다. 한 Tablet의 크기는 보통 100~200MB다.
- Row는 n개의 **Column-Family(Column의 모음)**을 가질 수 있다.
    - Column-Family는 Column-Key, Value, Timestamp의 형태로 데이터를 저장하며, 사전적 순서로 정렬된다.
- 동일한 Column-Key에 대해 **타임스탬프(Timestamp)가 다른 여러 버전의 값으로 존재**할 수 있으며, 칼럼 값의 버전 관리를 위해 사용된다.

## 페일오버(Failover)

- 특정 노드 **장애 발생 시**, 해당 노드에서 서비스되던 **Tablet을 다른 노드로 재할당**시킨다. 재할당 받은 노드는 GFS에 저장된 변경 로그 파일, 인덱스 파일, 데이터 파일 등을 이용해 데이터 서비스를 위한 초기화 작업 수행 후 다시 데이터 서비스를 한다.
- 빅테이블의 SPOF(Single Point Of Failure)는 마스터다.
    - SPOF : 시스템 구성 요소 중 동작하지 않으면 전체 시스템이 중단되는 요소
    - 분산 락 서비스를 제공하는 Chubby를 이용해 Master를 모니터링하다가, 장애 발생 시 가용한 노드가 마스터 역할을 수행하도록 한다.
    - **Chubby는 폴트톨러런스 지원 구조라, 절대 장애가 발생하지 않는다.**
- 빅테이블은 데이터 저장소를 위해 별도의 클러스터를 구성하기보다 파일시스템, Map&Reduce 컴퓨팅 클러스터와 동일한 클러스터 위에 구성된다.

## AppEngine

- 구글 클라우드 플랫폼의 일부로, 빅테이블을 사용한다.
- 사용자에게 직접 빅테이블 API를 공개하지 않고 추상 계층을 두고 있는데, 데이터 모델도 추상화되어 있다.
- 사용자 테이블을 생성할 경우, 빅테이블의 테이블로 생성되는 것이 아니라 빅테이블의 특정 테이블에 대한 한 영역만을 차지하게 된다.
- 빅테이블에서는 별도의 사용자 정의 인덱스를 제공하지 않지만, AppEngine에서는 사용자가 수행하는 쿼리를 분석해 자동으로 인덱스를 생성해준다.
- AppEngine에서 생성한 인덱스도 빅테이블의 특정 테이블 또는 테이블 내의 컬럼(Column)으로 저장된다.

# HBase

- **하둡 분산 파일 시스템(HDFS)를 기반**으로 구현된 **칼럼 기반** 분산 데이터베이스로, 파워셋에서 구글의 빅테이블을 모델로 하여 만들었다.
- **관계형 구조가 아니며, SQL을 지원하지 않는다.**
- 비구조화된 데이터에 더 적합하며, 대규모 데이터에서 실시간 읽기/쓰기 작업이 필요할 때 사용할 수 있다.
- 노드만 추가하면 선형으로 확장이 가능하며, 클러스터를 통한 데이터 복제 기능을 제공한다.
- RDBMS와 달리 **수평적으로 확장성이 있어 큰 테이블에 적합**하며, 단일 행의 트랜잭션을 보장한다.
- 로우키에 대한 인덱싱만 지원하며, Zookeeper를 이용한 고가용성을 보장한다.

# 아마존 SimpleDB

- 아마존의 데이터 서비스 플랫폼으로, 웹 애플리케이션에서 사용하는 데이터의 실시간 처리를 지원한다.
- 주로 아마존의 다른 플랫폼 서비스와 같이 사용되는데, EC2, S3 등과 같은 내부 서비스 간 네트워크 트래픽은 무료이고, 외부와의 In/Out 트래픽은 요금 부과하는 가격 정책 때문이다.
- 사용자는 EC2에서 수행되는 웹 서버로 접근하고, 웹 서버에서 SimpleDB의 데이터를 조회해 적절히 가공 후 사용자에게 제공하는 형태로 구성된다.
- 하나의 데이터를 여러 복제본을 유지하는 방식으로 가용성을 높이며, 트랜잭션 종료 후 데이터가 모든 노드에 즉시 반영되지 않고 초 단위로 지연 동기화되는 "Eventual Consistency" 정책을 취한다.
- 관계형 데이터 모델과 표준 SQL을 지원하지 않으며, 전용 쿼리 언어를 이용하여 데이터를 조회한다.
- 데이터 모델은 별도의 스키마(Schema)가 없는 구조이다.
- 여러 도메인(테이블과 동일 개념)에 걸친 쿼리는 허용되지 않으며, 한 번에 하나의 도메인에 대해서만 쿼리를 수행해야 한다.
    - 1:N(Master-Slave) 관계의 데이터 모델을 갖는 두 개의 도메인으로부터 데이터를 조회할 경우, 쿼리가 여러 번 수행해야 하는 단점이 있다.

## 구성 요소

### 도메인(Domain)

- RDB의 **"테이블(Table)"**과 동일한 개념이다.
- 최대 10GB의 데이터를 저장할 수 있으며, 사용자는 100개의 도메인을 가질 수 있다.
- 사용자는 최대 1,000GB의 데이터를 SimpleDB에 저장 가능하다.

### 아이템(Item)

- RDB의 **"레코드(Record)"**와 동일한 개념이다.
- 독립적인 객체를 나타내며, 1개 이상 256개 이하의 Attribute를 가진다.

### 속성(Attribute)

- RDB의 **"컬럼(Column)"**과 동일한 개념이지만, 사용 전 미리 정의할 필요가 없다.
- Name, Value 쌍으로 데이터를 저장하고, Name은 Attribute의 이름에 해당한다.
- Item의 **특정 Attribute(Cell)에는 여러 개의 값을 저장**할 수 있다.

### 값(Value)

- 각 Item에서 Attribute을 갖는 값

## 제공되는 API

클라이언트는 SOAP 또는 REST 프로토콜을 이용하여 SimpleDB 이용 가능하다.

|구분            |내용                                                                                 |
|:--------------:|:------------------------------------------------------------------------------------|
|CreateDomain    |도메인 생성                                                                          |
|DeleteDomain    |도메인 삭제                                                                          |
|ListDomains     |모든 도메인의 목록을 가져옴                                                          |
|PutAttributes   |Item을 생성하고 Attribute에 값을 추가                                                |
|DeleteAttributes|Attribute 값을 삭제                                                                  |
|GetAttributes   |Attribute의 값을 조회                                                                |
|Query           |조건에 맞는 여러 Item 조회 / 최대 5초 이내 수행되어야 하며, 최대 Item 수는 256개이다.|

# 마이크로소프트 SSDS

- SSDS(SQL Server Data Service)는 마이크로소프트에서 2008년 4월 베타서비스 실시한 데이터 서비스로, 고가용성을 보장한다.

## 구성 요소

- **컨테이너** : 테이블과 유사 개념이지만, 하나의 컨테이너에 여러 종류의 엔티티 저장 가능하다.
- **엔티티** : 레코드와 유사 개념이지만, 하나의 엔티티는 여러 property를 가질 수 있으며, pproperty는 name-value 쌍으로 저장된다.

## 특징

- 애플리케이션 개발 시 관련 정보를 하나의 컨테이너에 저장할 수 있다.
    - RDB 사용 시 Order와 OrderDetail을 각각의 테이블로 생성해야하지만, SSDS는 하나의 컨테이너에 Order와 OrderDetail 엔티티를 저장할 수 있다.
- 해당 방식은 많은 컨테이너가 생성되는데, 이들을 여러 노드에 분산하여 관리한다.
- SOAP/REST 기반 프로토콜을 지원하며 API는 아래와 같다.
    - 컨테이너 생성/삭제, 엔티티의 생성/삭제/조회, 쿼리(하나의 컨테이너만 대상)